# ClipFlow AI — 新手入門指南

> 從零開始，一步步帶你啟動並使用 ClipFlow AI 語音標記自動粗剪工具。

---

## 目錄

1. [環境需求](#1-環境需求)
2. [安裝步驟](#2-安裝步驟)
3. [啟動服務](#3-啟動服務)
4. [使用流程](#4-使用流程)
5. [匯出成果](#5-匯出成果)
6. [常見問題](#6-常見問題)

---

## 1. 環境需求

在開始之前，請確認你的電腦已安裝以下工具：

| 工具        | 最低版本 | 用途            | 安裝方式                                           |
| ----------- | -------- | --------------- | -------------------------------------------------- |
| **Python**  | 3.11+    | 後端執行環境    | [python.org](https://www.python.org/downloads/)    |
| **uv**      | 最新版   | Python 套件管理 | `curl -LsSf https://astral.sh/uv/install.sh \| sh` |
| **Node.js** | 18+      | 前端執行環境    | [nodejs.org](https://nodejs.org/)                  |
| **FFmpeg**  | 6.0+     | 音訊/影片處理   | `brew install ffmpeg`（macOS）                     |

### 驗證安裝

打開終端機（Terminal），逐一執行以下指令確認：

```bash
python3 --version    # 應顯示 Python 3.11 以上
uv --version         # 應顯示 uv 版本號
node --version       # 應顯示 v18 以上
ffmpeg -version      # 應顯示 ffmpeg 版本資訊
```

> ⚠️ 如果任一指令顯示「command not found」，請先安裝該工具再繼續。

---

## 2. 安裝步驟

### 2.1 取得專案

將專案資料夾放到你習慣的位置，然後用終端機進入：

```bash
cd /你的路徑/ClipFlow\ SaaS
```

### 2.2 安裝後端依賴

```bash
cd backend
uv sync
```

> 💡 這會自動建立 `.venv` 虛擬環境並安裝所有 Python 套件。  
> 首次執行可能需要 1～2 分鐘。

### 2.3 安裝前端依賴

```bash
cd ../frontend
npm install
```

> 💡 這會安裝 Next.js 及所有前端套件。

---

## 3. 啟動服務

ClipFlow AI 由**後端**（API 伺服器）和**前端**（網頁介面）組成，需要分別啟動。

### 3.1 啟動後端

開啟**第一個終端機視窗**：

```bash
cd backend
uv run uvicorn app.main:app --reload --port 8000
```

看到以下訊息表示成功：

```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process
```

> 💡 `--reload` 參數代表修改程式碼後會自動重新載入，開發時很方便。

### 3.2 啟動前端

開啟**第二個終端機視窗**（不要關閉第一個）：

```bash
cd frontend
npm run dev
```

看到以下訊息表示成功：

```
▲ Next.js 16.x.x
- Local: http://localhost:3000
```

### 3.3 開啟網頁

打開瀏覽器，前往：

👉 **http://localhost:3000**

你應該會看到 ClipFlow AI 的深色主題首頁。

---

## 4. 使用流程

### 步驟一：建立專案

1. 在首頁的輸入框中，輸入專案名稱（例如：`EP.12 開箱影片`）
2. 點擊 **「＋ 新建專案」** 按鈕
3. 專案卡片會出現在下方，狀態顯示為 **「待上傳」**

### 步驟二：上傳影片

1. 在剛建立的專案卡片上，點擊 **「📤 上傳影片」**
2. 選擇你的影片檔案（支援 `.mp4`、`.mov`、`.mkv`、`.avi`、`.webm`、`.mts`）
3. 上傳完成後，系統會**自動開始分析**

### 步驟三：等待分析完成

分析過程會自動執行以下步驟：

```
音訊擷取 → 語音辨識（STT）→ 標記偵測 → 自動切片
```

- 專案卡片會顯示**進度條**
- 分析時間取決於影片長度（1 分鐘影片約需 30 秒～2 分鐘）
- 狀態變為 **「已完成」** 即表示分析結束

> 📝 **首次分析**時，系統會下載語音辨識模型（約 150MB），所以會比較久，請耐心等候。後續分析會使用快取，速度會快很多。

### 步驟四：檢視與編輯結果

1. 點擊 **「✏️ 開啟工作區」** 進入專案工作區
2. 左側面板顯示：
   - 片段統計（總數、啟用數、預估長度）
   - 匯出按鈕
3. 右側主區切換頁籤：

#### 🎬 時間軸片段

- 每個片段卡片顯示**起始/結束時間**和**觸發標記**
- ✅ **勾選框**：啟用或停用該片段（停用的片段不會被匯出）
- 🕐 **點擊時間**：可以手動微調起始或結束時間點

#### 📝 完整逐字稿

- 顯示語音辨識的完整文字
- 每一段文字前方有對應的時間戳記

---

## 5. 匯出成果

在工作區左側的「📤 匯出」區域，點擊對應的格式按鈕：

| 格式      | 說明                      | 適用情境                           |
| --------- | ------------------------- | ---------------------------------- |
| **EDL**   | CMX 3600 編輯決定清單     | 匯入 DaVinci Resolve、Premiere Pro |
| **XML**   | Final Cut Pro XML (XMEML) | 匯入 Final Cut Pro                 |
| **SRT**   | 字幕檔（已過濾關鍵字）    | 搭配影片使用字幕                   |
| **VIDEO** | 合併後的 MP4 檔案         | 直接預覽或分享粗剪結果             |

> 💡 **推薦工作流程**：匯出 EDL 或 XML → 匯入你慣用的剪輯軟體 → 進行精細剪輯。

---

## 6. 常見問題

### ❓ 打開網頁顯示「無法連線後端」

**原因**：後端尚未啟動或已中斷。

**解法**：確認第一個終端機中 uvicorn 正在執行，若已中斷請重新執行：

```bash
cd backend && uv run uvicorn app.main:app --reload --port 8000
```

---

### ❓ 分析卡在「分析中」很久不動

**可能原因**：

- 首次執行正在下載語音模型（請等待）
- 影片太長（10 分鐘以上影片需要較長時間）

**解法**：

- 查看後端終端機的輸出訊息，確認是否有錯誤
- 可嘗試較短的影片先測試

---

### ❓ 語音辨識結果不準確

**解法**：

- 確認拍攝時說的「NG」「OK」等標記夠清晰
- 可在 API 設定中調整語言參數（預設為中文 `zh`）
- 嘗試更大的模型（`small` 或 `medium`），但會需要更多時間

---

### ❓ 如何停止服務？

在各自的終端機視窗中按 `Ctrl + C` 即可停止：

- 第一個終端機：停止後端
- 第二個終端機：停止前端

---

### ❓ 支援哪些影片格式？

MP4、MOV、MKV、AVI、WebM、MTS。基本上 FFmpeg 能處理的格式都支援。

---

### ❓ 專案資料儲存在哪裡？

所有資料存放在 `backend/data/` 目錄下，每個專案一個子資料夾，包含：

```
backend/data/
└── proj_xxxxxxxx/        # 專案 ID
    ├── project.json      # 專案設定
    ├── transcript.json   # 逐字稿
    ├── segments.json     # 片段清單
    ├── audio.wav         # 擷取的音訊
    └── 你的原始影片.mp4   # 上傳的影片
```

---

## 錄製時的語音標記建議

為了讓 ClipFlow AI 準確辨識，錄製時請使用**清楚且一致**的口令：

| 情境           | 建議口令     | 說明                               |
| -------------- | ------------ | ---------------------------------- |
| 講錯或需要重來 | **「NG」**   | 系統會標記此處需要刪除             |
| 重講滿意       | **「OK」**   | 系統會保留 NG 到 OK 之間重講的段落 |
| 區間模式開始   | **「開始」** | 標記保留段落的起點                 |
| 區間模式結束   | **「結束」** | 標記保留段落的終點                 |

> 💡 建議在說口令時稍微停頓，讓語音辨識更容易偵測到。

---

祝你使用愉快！🎬✂️
